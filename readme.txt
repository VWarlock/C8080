При выводе графики проверить.

// Найти прошлый цвет
char* color = a-1;
for(*a < 0x80 || *a > 0x9F; a--)
prevColor = *a;
// Если цвет не изменился. ТО байт смены цвета устаналивать не надо.
if(prevColor != color) {
  memcpy_back(a+1, a, linelen-x);
  *a = color;
  memcpy_back(a+2+stringlen, a+stringlen, linelen-x); 
  *a = prevColor
}
//
for(i=0; 
Если наш текст затирает байты смены цвета, то текст надо сдвинуть влево на местах этих байт.


- Если надо уставить байт смены цвета, то надо сдвинуть всю строку право (для вставки). А еще вставить байт смены цвета на исходный цвет в конце строки.
- 